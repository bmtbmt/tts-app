<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>·ª®ng d·ª•ng h·ªçc ph√°t √¢m v·ªõi SpeechSynthesis API</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: auto; }
    textarea { width: 100%; height: 80px; margin-bottom: 10px; }
    select, input[type=range] { width: 100%; margin: 6px 0; }
    button { padding: 8px 16px; margin: 4px; }
    label { font-weight: bold; display: block; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>üó£Ô∏è ·ª®ng d·ª•ng h·ªçc ph√°t √¢m b·∫±ng TTS (Native)</h2>

  <label for="exampleSelect">üìö Ch·ªçn m·∫´u c√¢u:</label>
  <select id="exampleSelect" onchange="setExampleText()">
    <option value="">-- Ch·ªçn m·∫´u --</option>
    <option>Hello! How are you?</option>
    <option>This is a text-to-speech demo.</option>
    <option>Xin ch√†o! T√¥i ƒëang h·ªçc ph√°t √¢m.</option>
    <option>I love learning English pronunciation.</option>
  </select>

  <label for="text">‚úèÔ∏è Nh·∫≠p vƒÉn b·∫£n:</label>
  <textarea id="text">Hello! How are you?</textarea>

  <label for="voiceSelect">üó£Ô∏è Ch·ªçn gi·ªçng:</label>
  <select id="voiceSelect"></select>

  <label for="rate">‚è© T·ªëc ƒë·ªô n√≥i: <span id="rateVal">1.0</span></label>
  <input type="range" id="rate" min="0.5" max="2.0" value="1.0" step="0.1" oninput="updateSlider('rate')"/>

  <label for="pitch">üéµ Cao ƒë·ªô: <span id="pitchVal">1.0</span></label>
  <input type="range" id="pitch" min="0.5" max="2.0" value="1.0" step="0.1" oninput="updateSlider('pitch')"/>

  <div style="margin-top:10px;">
    <button onclick="speak()">‚ñ∂Ô∏è Nghe ph√°t √¢m</button>
    <button onclick="cancel()">‚èπÔ∏è D·ª´ng l·∫°i</button>
  </div>

  <p id="status"></p>

  <script>
    const synth = window.speechSynthesis;
    const voiceSelect = document.getElementById("voiceSelect");
    const rateInput = document.getElementById("rate");
    const pitchInput = document.getElementById("pitch");

    function populateVoices() {
      const voices = synth.getVoices();
      voiceSelect.innerHTML = "";

      voices.forEach((voice, i) => {
        const option = document.createElement("option");
        option.value = i;
        option.textContent = `${voice.name} (${voice.lang})`;
        voiceSelect.appendChild(option);
      });
    }

    populateVoices();
    if (speechSynthesis.onvoiceschanged !== undefined) {
      speechSynthesis.onvoiceschanged = populateVoices;
    }

    function updateSlider(id) {
      const val = document.getElementById(id).value;
      document.getElementById(id + "Val").textContent = val;
    }

    function setExampleText() {
      const example = document.getElementById("exampleSelect").value;
      if (example) document.getElementById("text").value = example;
    }

    function speak() {
      const text = document.getElementById("text").value;
      const utter = new SpeechSynthesisUtterance(text);

      const voices = synth.getVoices();
      utter.voice = voices[voiceSelect.value];

      utter.rate = parseFloat(rateInput.value);
      utter.pitch = parseFloat(pitchInput.value);

      synth.cancel(); // Stop any ongoing speech
      synth.speak(utter);
      document.getElementById("status").textContent = "üîä ƒêang ƒë·ªçc...";
    }

    function cancel() {
      synth.cancel();
      document.getElementById("status").textContent = "‚èπÔ∏è ƒê√£ d·ª´ng.";
    }
  </script>
</body>
</html>